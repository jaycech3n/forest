<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css"
  integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js"
  integrity="sha384-PwRUT/YqbnEjkZO0zZxNqcxACrXe+j766U2amXcgMg5457rve2Y7I6ZJSm2A0mS4" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/contrib/auto-render.min.js"
  integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"></script>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link
  href="https://fonts.googleapis.com/css2?family=Inria+Sans:ital,wght@0,300;0,400;0,700;1,300;1,400;1,700&display=swap"
  rel="stylesheet">

<script defer type="module" src="https://unpkg.com/ninja-keys?module"></script>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const ninja = document.querySelector('ninja-keys')
    ninja.data = []

    {{ if eq hugo.Environment "development" }}
    {{ $projectPath := or (os.Getenv "HUGO_PROJECT_PATH" ) (os.Getenv "PWD") }}
    ninja.data.push({
      id: 'Edit',
      title: 'Edit current file in Visual Studio Code',
      section: 'File Commands',
      handler: () => {
        window.location.href = 'vscode://file/{{ $projectPath }}/content/{{ .File.Path }}'
      }
    });
    {{ end }}

    ninja.data.push({
      id: 'ExpandAll',
      title: 'Expand all outline nodes',
      section: 'Page Interaction',
      handler: () => {
        document.body.querySelectorAll("details").forEach((e) =>
          e.setAttribute("open", true)
        )
      }
    });

    ninja.data.push({
      id: 'CollapseAll',
      title: 'Collapse all outline nodes',
      section: 'Page Interaction',
      handler: () => {
        const firstDetails = document.body.querySelector("details")
        if (!firstDetails) return
        firstDetails.querySelectorAll("details").forEach((e) =>
          e.removeAttribute("open")
        )
      }
    });

    ninja.data.push({
      id: 'Home',
      title: 'Go to home page',
      section: 'Site Navigation',
      handler: () => {
        window.location.href = '{{.Site.BaseURL}}'
      }
    });

    {{range .Site.RegularPages}}
    ninja.data.push({
      id: 'AllNotes-{{.File.ContentBaseName}}',
      title: '{{ .Params.Taxon }} #{{.File.ContentBaseName}}: {{.Title}}',
      section: 'All Notes',
      handler: () => {
        window.location.href = '{{.Permalink}}'
      }
    });
    {{end}}
  });
</script>
