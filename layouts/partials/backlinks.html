{{ $page := .page }}

{{ $fwdPages := slice }}
{{ $bwdPages := slice }}
{{ $dwdPages := slice }}
{{ $upwdPages := slice }}

{{ range $page.Store.Get "bwdSlugs" }}
{{ with site.GetPage . }}
{{ $bwdPages = $bwdPages | append . }}
{{ end }}
{{ end }}

{{ range $page.Store.Get "fwdSlugs" }}
{{ with site.GetPage . }}
{{ $fwdPages = $fwdPages | append . }}
{{ end }}
{{ end }}

{{ range $page.Store.Get "upwdSlugs" }}
{{ with site.GetPage . }}
{{ $upwdPages = $upwdPages | append . }}
{{ end }}
{{ end }}

{{ range $page.Store.Get "dwdSlugs" }}
{{ with site.GetPage . }}
{{ $dwdPages = $dwdPages | append . }}
{{ end }}
{{ end }}

{{ with $upwdPages }}
<section class="backlinks">
  {{ printf "%s" ($.heading | default "<h4>Context</h4>") | safeHTML }}
  <nav>
    <ul>
      {{ range . }}
      <li>
        <a class="local" href="{{ .RelPermalink }}">
          {{with .Title}}
          {{. | markdownify}}
          {{end}}
          <span class="slug">#{{.File.ContentBaseName}}</span>
        </a>
      </li>
      {{ end }}
    </ul>
  </nav>
</section>
{{ end }}

{{ with $fwdPages }}
<section class="backlinks">
  {{ printf "%s" ($.heading | default "<h4>Related</h4>") | safeHTML }}
  <nav>
    <ul>
      {{ range . }}
      <li>
        <a class="local" href="{{ .RelPermalink }}">
          {{with .Title}}
          {{. | markdownify}}
          {{end}}
          <span class="slug">#{{.File.ContentBaseName}}</span>
        </a>
      </li>
      {{ end }}
    </ul>
  </nav>
</section>
{{ end }}


{{ with $bwdPages }}
<section class="backlinks">
  {{ printf "%s" ($.heading | default "<h4>Backlinks</h4>") | safeHTML }}
  <nav>
    <ul>
      {{ range . }}
      <li>
        <a class="local" href="{{ .RelPermalink }}">
          {{with .Title |}}
          {{. | markdownify}}
          {{end}}
          <span class="slug">#{{.File.ContentBaseName}}</span>
        </a>
      </li>
      {{ end }}
    </ul>
  </nav>
</section>
{{ end }}
